<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quantitative Bias Analysis for Epidemiologic Data • episensr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quantitative Bias Analysis for Epidemiologic Data">
<meta property="og:description" content="episensr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">episensr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/episensr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/b_probabilistic.html">Probabilistic Sensitivity Analysis</a>
    </li>
    <li>
      <a href="../articles/c_multiple_bias.html">Multiple Bias Modeling</a>
    </li>
    <li>
      <a href="../articles/d_other_sens.html">Additional Sensitivity Analyses</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dhaine/episensr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quantitative Bias Analysis for Epidemiologic Data</h1>
                        <h4 class="author">Denis Haine</h4>
            
<<<<<<< HEAD
<<<<<<< HEAD
            <h4 class="date">2020-03-16</h4>
      
=======
            <h4 class="date">2020-10-08</h4>
>>>>>>> develop
=======
            <h4 class="date">2020-10-16</h4>
>>>>>>> develop
      
      <small class="dont-index">Source: <a href="https://github.com/dhaine/episensr/blob/master/vignettes/episensr.Rmd"><code>vignettes/episensr.Rmd</code></a></small>
      <div class="hidden name"><code>episensr.Rmd</code></div>

    </div>

    
    
<p>Quantitative bias analysis allows to estimate nonrandom errors in epidemiologic studies, assessing the magnitude and direction of biases, and quantifying their uncertainties. Every study has some random error due to its limited sample size, and is susceptible to systematic errors as well, from selection bias to the presence of (un)known confounders or information bias (measurement error, including misclassification). Bias analysis methods were compiled by Lash et al. in their book <a href="https://www.springer.com/us/book/9780387879604">“Applying Quantitative Bias Analysis to Epidemiologic Data”</a>. This package implements the various bias analyses from that book, which are also <a href="https://sites.google.com/site/biasanalysis/">available</a> (for some) as a spreadsheet or a SAS macro, as well as some additional approaches. This vignette provides some examples on how to use the package.</p>
<p>(<em>Note: A Shiny app is available for some functions, at <a href="https://dhaine.shinyapps.io/apisensr/" class="uri">https://dhaine.shinyapps.io/apisensr/</a>.</em>, using the R package <code>apisensr</code> which is based on <code>episensr</code>.)</p>
<p>Functions available in <code>episensr</code> are:</p>
<ul>
<li>
<code>selection</code>: Selection bias</li>
<li>
<code>mbias</code>: Selection bias caused by M bias</li>
<li>
<code>confounders</code>: Unmeasured or unknown confounders</li>
<li>
<code>confounders.poly</code>: Polytomous confounders</li>
<li>
<code>confounders.emm</code>: Unmeasured or unknown confounders in the presence of effect modification</li>
<li>
<code>confounders.limit</code>: Bounding the bias limits of unmeasured confounding</li>
<li>
<code>confounders.array</code>: Bias due to unmeasured confounders based on confounding imbalance among exposed and unexposed</li>
<li>
<code>confounders.ext</code>: Unmeasured confounders based on external measurement</li>
<li>
<code>confounders.evalue</code>: E-value due to unmeasured confounder</li>
<li>
<code>misclassification</code>: Disease or exposure misclassification</li>
<li>
<code>misclassification_cov</code>: Covariate misclassification</li>
<li>
<code>bootstrap</code>: Bootstrap resampling for selection and misclassification bias</li>
<li>
<code>multidimBias</code>: Multidimensional bias analysis</li>
<li>
<code>probsens.sel</code>: Probabilistic analysis for selection bias</li>
<li>
<code>probsens.conf</code>: Probabilistic analysis for unmeasured confounding</li>
<li>
<code>probsens</code>: Probabilistic analysis for misclassification</li>
<li>
<code>probsens.irr.conf</code>: Probabilistic analysis for unmeasured confounding of person-time data</li>
<li>
<code>probsens.irr</code>: Probabilistic analysis for exposure misclassification of person-time data</li>
<li>
<code>multiple bias</code>: Multiple bias modeling</li>
</ul>
<div id="selection-bias" class="section level2">
<h2 class="hasAnchor">
<a href="#selection-bias" class="anchor"></a>Selection Bias</h2>
<p>We will use a case-control study by <a href="http://www.ncbi.nlm.nih.gov/pubmed/16523014">Stang et al.</a> on the relation between mobile phone use and uveal melanoma. The observed odds ratio for the association between regular mobile phone use vs. no mobile phone use with uveal melanoma incidence is 0.71 [95% CI 0.51-0.97]. But there was a substantial difference in participation rates between cases and controls (94% vs 55%, respectively) and so selection bias could have an impact on the association estimate. The 2X2 table for this study is the following:</p>
<table class="table">
<thead><tr class="header">
<th align="right"></th>
<th align="center">Regular use</th>
<th align="center">No use</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">Cases</td>
<td align="center">136</td>
<td align="center">107</td>
</tr>
<tr class="even">
<td align="right">Controls</td>
<td align="center">297</td>
<td align="center">165</td>
</tr>
</tbody>
</table>
<p>We use the function <code>selection</code> as shown below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">episensr</span><span class="op">)</span></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">stang</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selection.html">selection</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">136</span>, <span class="fl">107</span>, <span class="fl">297</span>, <span class="fl">165</span><span class="op">)</span>,
                          dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UM+"</span>, <span class="st">"UM-"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mobile+"</span>, <span class="st">"Mobile-"</span><span class="op">)</span><span class="op">)</span>,
                          nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                   bias_parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.94</span>, <span class="fl">.85</span>, <span class="fl">.64</span>, <span class="fl">.25</span><span class="op">)</span><span class="op">)</span>
<span class="va">stang</span></pre></div>
<pre><code>## --Observed data-- 
##          Outcome: UM+ 
##        Comparing: Mobile+ vs. Mobile- 
## 
##     Mobile+ Mobile-
## UM+     136     107
## UM-     297     165
## 
##                                        2.5%     97.5%
## Observed Relative Risk: 0.7984287 0.6518303 0.9779975
##    Observed Odds Ratio: 0.7061267 0.5143958 0.9693215
## ---
##                                                 
## Selection Bias Corrected Relative Risk: 1.483780
##    Selection Bias Corrected Odds Ratio: 1.634608</code></pre>
<p>The various <code>episensr</code> functions return an object which is a list containing the input and output variables. You can check it out with <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code>.</p>
<p>The 2X2 table is provided as a matrix and selection probabilities given with the argument <code>bias_parms</code>, a vector with the 4 probabilities (guided by the participation rates in cases and controls) in the following order: among cases exposed, among cases unexposed, among noncases exposed, and among noncases unexposed. The output shows the observed 2X2 table and the observed odds ratio (and relative risk), followed by the corrected ones.</p>
</div>
<div id="misclassification-bias" class="section level2">
<h2 class="hasAnchor">
<a href="#misclassification-bias" class="anchor"></a>Misclassification Bias</h2>
<p>Misclassification bias can be assessed with the function <code>misclassification</code>. Confidence intervals for corrected association due to exposure misclassification are also directly available, or the estimates can also be bootstrapped (see below). The confidence intervals from the variance of the corrected odds ratio estimator in the <code>misclassification</code> function are computed as in <a href="http://onlinelibrary.wiley.com/doi/10.1002/sim.4780070704/full#abstract">Greenland et al.</a> and <a href="http://www.sciencedirect.com/science/article/pii/S1047279706000688">Chu et al.</a>. Using the example in Chu et al. of a case-control study of cigarette smoking and invasive pneumococcal disease, the unadjusted odds ratio is 4.32, with a 95% confidence interval of 2.96 to 6.31. Let’s say the sensitivity of self-reported smoking is 94% and specificity is 97%, for both the case and control groups:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="../reference/misclassification.html">misclassification</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">126</span>, <span class="fl">92</span>, <span class="fl">71</span>, <span class="fl">224</span><span class="op">)</span>,
                         dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Case"</span>, <span class="st">"Control"</span><span class="op">)</span>,
                                         <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Smoking +"</span>, <span class="st">"Smoking - "</span><span class="op">)</span><span class="op">)</span>,
                         nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                  type <span class="op">=</span> <span class="st">"exposure"</span>,
                  bias_parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.94</span>, <span class="fl">0.94</span>, <span class="fl">0.97</span>, <span class="fl">0.97</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## --Observed data-- 
##          Outcome: Case 
##        Comparing: Smoking + vs. Smoking -  
## 
##         Smoking + Smoking - 
## Case          126         92
## Control        71        224
## 
##                                      2.5%    97.5%
## Observed Relative Risk: 2.196866 1.796016 2.687181
##    Observed Odds Ratio: 4.320882 2.958402 6.310846
## ---
##                                                              2.5%    97.5%
## Misclassification Bias Corrected Relative Risk: 2.377254                  
##    Misclassification Bias Corrected Odds Ratio: 5.024508 3.282534 7.690912</code></pre>
<p>The corrected odds ratio is now 5.02, with a widened 95% confidence interval (3.28 to 7.69). Note the bias despite the large sensitivity and specificity.</p>
<p>You can even reproduce the contour plots in Chu et al. paper!</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>Se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.582</span>, <span class="fl">1</span>, <span class="fl">0.02</span><span class="op">)</span>,
                   Sp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.762</span>, <span class="fl">1</span>, <span class="fl">0.02</span><span class="op">)</span><span class="op">)</span>

<span class="va">dat</span><span class="op">$</span><span class="va">OR_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>,
                  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/misclassification.html">misclassification</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">126</span>, <span class="fl">92</span>, <span class="fl">71</span>, <span class="fl">224</span><span class="op">)</span>,
                                                       nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                                                type <span class="op">=</span> <span class="st">"exposure"</span>,
                                                bias_parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">adj.measures</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="va">dat</span><span class="op">$</span><span class="va">OR_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">OR_c</span>, <span class="fl">2</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tdhock/directlabels">directlabels</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Se</span>, y <span class="op">=</span> <span class="va">Sp</span>, z <span class="op">=</span> <span class="va">OR_c</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">..level..</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.32</span>, <span class="fl">6.96</span>, <span class="fl">8.56</span>, <span class="fl">12.79</span>, <span class="fl">23.41</span>, <span class="fl">432.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="st">"4.32"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">OR_c</span><span class="op">)</span>, high <span class="op">=</span> <span class="st">'red'</span>, low <span class="op">=</span> <span class="st">'green'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">.1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">.1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.025</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.025</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Specificity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Estimates of Corrected OR"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span><span class="op">(</span><span class="va">p1</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"far.from.others.borders"</span>, <span class="st">"calc.boxes"</span>, <span class="st">"enlarge.box"</span>, 
                      hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">.5</span>, box.color <span class="op">=</span> <span class="cn">NA</span>, cex <span class="op">=</span> <span class="fl">.6</span>,
                      fill <span class="op">=</span> <span class="st">"transparent"</span>, <span class="st">"draw.rects"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="figure">
<img src="episensr_files/figure-html/unnamed-chunk-1-1.png" alt="Contour plot of point estimates of corrected odds ratio (OR)" width="576"><p class="caption">
Contour plot of point estimates of corrected odds ratio (OR)
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">dat</span><span class="op">$</span><span class="va">ORc_lci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>,
                     <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/misclassification.html">misclassification</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">126</span>, <span class="fl">92</span>, <span class="fl">71</span>, <span class="fl">224</span><span class="op">)</span>,
                                                          nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                                                   type <span class="op">=</span> <span class="st">"exposure"</span>,
                                                   bias_parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">adj.measures</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="va">dat</span><span class="op">$</span><span class="va">ORc_lci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">ORc_lci</span>, <span class="fl">2</span><span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Se</span>, y <span class="op">=</span> <span class="va">Sp</span>, z <span class="op">=</span> <span class="va">ORc_lci</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">..level..</span><span class="op">)</span>,
                 breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.05</span>, <span class="fl">4.64</span>, <span class="fl">5.68</span>, <span class="fl">7.00</span>, <span class="fl">9.60</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="st">"2.96"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">ORc_lci</span><span class="op">)</span>, high <span class="op">=</span> <span class="st">'red'</span>, low <span class="op">=</span> <span class="st">'green'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">.1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">.1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.025</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.025</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Specificity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"95% LCI of Corrected OR"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span><span class="op">(</span><span class="va">p3</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"far.from.others.borders"</span>, <span class="st">"calc.boxes"</span>, <span class="st">"enlarge.box"</span>, 
                           hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">.5</span>, box.color <span class="op">=</span> <span class="cn">NA</span>, cex <span class="op">=</span> <span class="fl">.6</span>,
                           fill <span class="op">=</span> <span class="st">"transparent"</span>, <span class="st">"draw.rects"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="figure">
<img src="episensr_files/figure-html/unnamed-chunk-2-1.png" alt="Contour plot of 95% lower confidence limit of corrected OR" width="576"><p class="caption">
Contour plot of 95% lower confidence limit of corrected OR
</p>
</div>
<p>Covariate misclassification is available via the function <code>misclassification.cov</code>. For example, the paper by <a href="http://www.bmj.com/content/330/7495/815">Berry et al.</a> looked if misclassification of the confounding variable <em>in vitro fertilization</em> (IVF), a confounder, resulted wrongly on an association between increase folic acid and having twins. IVF increases the risk of twins, and women undergoing IVF might be more likely to take folic acid supplements, i.e. IVF would be a confounder between vitamins and twins. Data on IVF were not available and a proxy for it was used, <em>period of involuntary childlessness</em>. However, it was a poor proxy for IVF, with a sensitivity of 60% and a specificity of 95%. These bias parameters were assumed to be nondifferential. Here’s the code with <code>episensr</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="fu"><a href="../reference/misclassification_cov.html">misclassification.cov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1319</span>, <span class="fl">38054</span>, <span class="fl">5641</span>, <span class="fl">405546</span>, <span class="fl">565</span>, <span class="fl">3583</span>,
                              <span class="fl">781</span>, <span class="fl">21958</span>, <span class="fl">754</span>, <span class="fl">34471</span>, <span class="fl">4860</span>, <span class="fl">383588</span><span class="op">)</span>,
                            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Twins+"</span>, <span class="st">"Twins-"</span><span class="op">)</span>,
                                            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Folic acid+"</span>, <span class="st">"Folic acid-"</span><span class="op">)</span>,
                                            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Total"</span>, <span class="st">"IVF+"</span>, <span class="st">"IVF-"</span><span class="op">)</span><span class="op">)</span>,
                            dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,
                      bias_parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="fl">.6</span>, <span class="fl">.95</span>, <span class="fl">.95</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## --Observed data-- 
##          Outcome: Twins+ 
##        Comparing: Folic acid+ vs. Folic acid- 
## 
## , , Total
## 
##        Folic acid+ Folic acid-
## Twins+        1319        5641
## Twins-       38054      405546
## 
## , , IVF+
## 
##        Folic acid+ Folic acid-
## Twins+         565         781
## Twins-        3583       21958
## 
## , , IVF-
## 
##        Folic acid+ Folic acid-
## Twins+         754        4860
## Twins-       34471      383588
## 
## 
##                                      2.5%    97.5%
## Observed Relative Risk: 2.441910 2.301898 2.590437
##    Observed Odds Ratio: 2.491888 2.344757 2.648251
## ---
##                                                       Observed Corrected
##                       SMR RR adjusted for confounder: 2.261738  1.000235
##    RR due to confounding by misclassified confounder: 1.079661  2.441337
##           Mantel-Haenszel RR adjusted for confounder: 2.228816  1.000187
## MH RR due to confounding by misclassified confounder: 1.095608  2.441452
##                       SMR OR adjusted for confounder: 2.337898  1.000304
##    OR due to confounding by misclassified confounder: 1.065867  2.491131
##           Mantel-Haenszel OR adjusted for confounder: 2.290469  1.000215
## MH OR due to confounding by misclassified confounder: 1.087938  2.491351</code></pre>
<p>While the non-adjusted analysis showed that women taking folic acid were 2.44 times more likely to have twins, after correcting for the misclassification of IVF, risk ratio is now null (= 1.0).</p>
</div>
<div id="uncontrolled-confounders" class="section level2">
<h2 class="hasAnchor">
<a href="#uncontrolled-confounders" class="anchor"></a>Uncontrolled Confounders</h2>
<p>We will use data from a cross-sectional study by <a href="http://www.ncbi.nlm.nih.gov/pubmed/8879763">Tyndall et al.</a> on the association between male circumcision and the risk of acquiring HIV, which might be confounded by religion. The code to account for unmeasured or unknown confounders is the following, where the 2X2 table is given as a matrix. We choose a risk ratio implementation, provide a vector defining the risk ratio associating the confounder with the disease, and the prevalence of the confounder, religion, among the exposed and the unexposed.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="va">tyndall</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confounders.html">confounders</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">105</span>, <span class="fl">85</span>, <span class="fl">527</span>, <span class="fl">93</span><span class="op">)</span>,
                              dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HIV+"</span>, <span class="st">"HIV-"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Circ+"</span>, <span class="st">"Circ-"</span><span class="op">)</span><span class="op">)</span>,
                              nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                       type <span class="op">=</span> <span class="st">"RR"</span>,
                       bias_parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.63</span>, <span class="fl">.8</span>, <span class="fl">.05</span><span class="op">)</span><span class="op">)</span>
<span class="va">tyndall</span></pre></div>
<pre><code>## --Observed data-- 
##          Outcome: HIV+ 
##        Comparing: Circ+ vs. Circ- 
## 
##      Circ+ Circ-
## HIV+   105    85
## HIV-   527    93
## 
##                                             2.5%     97.5%
##         Crude Relative Risk: 0.3479151 0.2757026 0.4390417
## Relative Risk, Confounder +: 0.4850550                    
## Relative Risk, Confounder -: 0.4850550                    
## ---
##                                         Adjusted RR
## Standardized Morbidity Ratio: 0.4850550   0.7172695
##              Mantel-Haenszel: 0.4850550   0.7172695</code></pre>
<p>The output gives the crude 2X2 table, the crude relative risk and confounder specific measures of association between exposure and outcome, and the relationship adjusted for the unknown confounder, using a standardized morbidity ratio (SMR) or a Mantel-Haenszel (MH) estimate of the risk ratio.</p>
<<<<<<< HEAD
</div>
<div id="unmeasured-confounding-and-e-value" class="section level2">
<h2 class="hasAnchor">
<a href="#unmeasured-confounding-and-e-value" class="anchor"></a>Unmeasured confounding and E-value</h2>
<p>E-value, introduced by <a href="https://annals.org/aim/article-abstract/2643434/sensitivity-analysis-observational-research-introducing-e-value">VanderWeele et al.</a>, is the minimum strength of association on the risk ratio scale that an unmeasured confounder would need to have with both the exposure and the outcome, conditional on the measured covariates, to fully explain away a specific exposure-outcome association.</p>
<p>For example, a study by <a href="https://www.thelancet.com/journals/lancet/article/PIIS0140-6736(87)90902-0/fulltext">Victoria et al.</a> found an association between formula-fed babies compared to breast-fed and respiratory death, RR = 3.9. What would be the strength of association for an unmeasured confounder needed to explain away this association? The E-value express the magnitude of the confounder associations that can produce confounding bias equal to the observed exposure-outcome association. This E-value is:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/confounders.evalue.html">confounders.evalue</a></span>(<span class="dt">est =</span> <span class="fl">3.9</span>, <span class="dt">lower_ci =</span> <span class="fl">1.8</span>, <span class="dt">upper_ci =</span> <span class="fl">8.7</span>, <span class="dt">type =</span> <span class="st">"RR"</span>)</a></code></pre></div>
<pre><code>## 
## --E-value--
##          Point estimate   CI closest to H_0
##      RR:       3.900000            1.800000
## E-value:       7.263034            3.000000</code></pre>
<p>The E-value is 7.26, i.e. an unmeasured confounder must have a risk ratio of at least 7.26 with both the exposure and the outcome, and above and beyond the measured confounders, to explain away the observed risk ratio of 3.9. A weaker unmeasured confounder could not explain this RR. E-value for the CI closest to the null (i.e. 1) can also be reported.</p>
<p>Similarly, the minimum magnitude of both confounder associations to move away the observed association can be assessed for a non-null hypothesis. For example, the effect of anti-depressant use during pregnancy on infant cardiac defects was 1.06 [0.93–1.22] (<a href="https://www.nejm.org/doi/full/10.1056/NEJMoa1312828">Huybrechts et al.</a>). The confidence interval includes 1 so no further unmeasured confounding is needed to shift the confidence interval to include 1, i.e. the E-value = 1. But what would be the strength of a confounder needed to shift RR to 1.2?</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/confounders.evalue.html">confounders.evalue</a></span>(<span class="dt">est =</span> <span class="fl">1.06</span>, <span class="dt">lower_ci =</span> <span class="fl">0.93</span>, <span class="dt">upper_ci =</span> <span class="fl">1.22</span>,</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                   <span class="dt">type =</span> <span class="st">"RR"</span>, <span class="dt">true_est =</span> <span class="fl">1.2</span>)</a></code></pre></div>
<pre><code>## 
## --E-value--
##          Point estimate   CI closest to H_0
##      RR:       1.060000            1.220000
## E-value:       1.518753            1.146837</code></pre>
<p>We need an unmeasured confounder with a RR of 1.5 each with the outcome, cardiac defect, and the exposure, anti-depressant use, to move the risk ratio to 1.2. A weaker confounder could not shift the observed RR.</p>
<p>E-value can also be computed when the effect measure is:</p>
<ul>
<li>OR or HR for rare outcomes (i.e. &lt; 15%), rate ratio for count and continuous outcomes: <code>RR</code>,</li>
<li>OR for common outcomes (i.e. &gt; 15%): <code>ORc</code>,</li>
<li>HR for common outcomes (i.e. &gt; 15%): <code>HRc</code>,</li>
<li>Difference in continuous outcomes, with standardized effect size <em>d</em> (mean of the outcome variable divided by the SD of the outcome) and an SE for this standardized effect size <em>s_d</em>, either with RR approximation or OR approximation (meta-analysis): <code>diff_RR</code> and <code>diff_OR</code>.</li>
</ul>
</div>
<div id="probabilistic-sensitivity-analysis-for-exposure-misclassification" class="section level2">
<h2 class="hasAnchor">
<a href="#probabilistic-sensitivity-analysis-for-exposure-misclassification" class="anchor"></a>Probabilistic Sensitivity Analysis for Exposure Misclassification</h2>
<p>We use a study on the effect of smoking during pregnancy on breast cancer risk by <a href="http://www.ncbi.nlm.nih.gov/pubmed/12946045">Fink &amp; Lash</a>, where we assume nondifferential misclassification of the exposure, smoking, with probability density functions for sensitivities (Se) and specificities (Sp) among cases and noncases equal to uniform distributions with a minimum of 0.7 and a maximum of 0.95 for sensitivities (0.9 and 0.99 respectively for specificities). We choose to correct for exposure misclassification with the argument <code>type = exposure</code>. We ask for 50000 replications (default is 1000). Don’t be shy with the number of iterations, episensr is fast.</p>
<p>The Se and Sp for cases (<code>seca</code>, <code>spca</code>) are given as a list with its first element referring to the type of distribution (choice between constant, uniform, triangular, trapezoidal, logit-logistic, and logit-normal) and the second element giving the distribution parameters (min and max for uniform distribution). By avoiding to provide information on the noncases (<code>seexp</code>, <code>spexp</code>), we are referring to a nondifferential misclassification.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">smoke.nd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/probsens.html">probsens</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">215</span>, <span class="dv">1449</span>, <span class="dv">668</span>, <span class="dv">4296</span>),</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                            <span class="dt">dimnames =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"BC+"</span>, <span class="st">"BC-"</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Smoke+"</span>, <span class="st">"Smoke-"</span>)),</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                            <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                     <span class="dt">type =</span> <span class="st">"exposure"</span>,</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">                     <span class="dt">reps =</span> <span class="dv">50000</span>,</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">                     <span class="dt">seca.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"uniform"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">7</span>, <span class="fl">.95</span>)),</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">                     <span class="dt">spca.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"uniform"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">9</span>, <span class="fl">.99</span>)))</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">smoke.nd</a></code></pre></div>
<pre><code>## --Observed data-- 
##          Outcome: BC+ 
##        Comparing: Smoke+ vs. Smoke- 
## 
##     Smoke+ Smoke-
## BC+    215   1449
## BC-    668   4296
## 
##                                         2.5%     97.5%
##  Observed Relative Risk: 0.9653825 0.8523766 1.0933704
##     Observed Odds Ratio: 0.9542406 0.8092461 1.1252141
## ---
##                                                  Median 2.5th percentile
##            Relative Risk -- systematic error: 0.9431650        0.8817325
##               Odds Ratio -- systematic error: 0.9253996        0.8478414
## Relative Risk -- systematic and random error: 0.9359816        0.8175818
##    Odds Ratio -- systematic and random error: 0.9162763        0.7664183
##                                               97.5th percentile
##            Relative Risk -- systematic error:         0.9612154
##               Odds Ratio -- systematic error:         0.9487841
## Relative Risk -- systematic and random error:         1.0690389
##    Odds Ratio -- systematic and random error:         1.0923026</code></pre>
<p>The output gives the 2X2 table, the observed measures of association, and the corrected measures of association.</p>
<p>We saved the <code>probsens</code> analysis in a new object <code>smoke.nd</code>. We can see its elements with the function <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(smoke.nd)</a></code></pre></div>
<pre><code>## List of 5
##  $ obs.data    : num [1:2, 1:2] 215 668 1449 4296
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:2] "BC+" "BC-"
##   .. ..$ : chr [1:2] "Smoke+" "Smoke-"
##  $ obs.measures: num [1:2, 1:3] 0.965 0.954 0.852 0.809 1.093 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:2] " Observed Relative Risk:" "    Observed Odds Ratio:"
##   .. ..$ : chr [1:3] " " "2.5%" "97.5%"
##  $ adj.measures: num [1:4, 1:3] 0.943 0.925 0.936 0.916 0.882 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:4] "           Relative Risk -- systematic error:" "              Odds Ratio -- systematic error:" "Relative Risk -- systematic and random error:" "   Odds Ratio -- systematic and random error:"
##   .. ..$ : chr [1:3] "Median" "2.5th percentile" "97.5th percentile"
##  $ sim.df      :'data.frame':    50000 obs. of  12 variables:
##   ..$ seca   : num [1:50000] 0.772 0.897 0.802 0.921 0.935 ...
##   ..$ seexp  : num [1:50000] 0.772 0.897 0.802 0.921 0.935 ...
##   ..$ spca   : num [1:50000] 0.919 0.94 0.912 0.943 0.965 ...
##   ..$ spexp  : num [1:50000] 0.919 0.94 0.912 0.943 0.965 ...
##   ..$ A1     : num [1:50000] 117 137 95 139 174 ...
##   ..$ B1     : num [1:50000] 1547 1527 1569 1525 1490 ...
##   ..$ C1     : num [1:50000] 386 442 321 446 548 ...
##   ..$ D1     : num [1:50000] 4578 4522 4643 4518 4416 ...
##   ..$ corr.RR: num [1:50000] 0.918 0.94 0.905 0.943 0.954 ...
##   ..$ corr.OR: num [1:50000] 0.893 0.922 0.877 0.925 0.94 ...
##   ..$ tot.RR : num [1:50000] 0.903 1.067 0.854 1.056 0.999 ...
##   ..$ tot.OR : num [1:50000] 0.873 1.09 0.812 1.075 0.999 ...
##  $ reps        : num 50000
##  - attr(*, "class")= chr [1:3] "episensr" "episensr.probsens" "list"</code></pre>
<p><code>smoke.nd</code> is a list of 4 elements where different information on the analysis done are saved. We have <code>smoke.nd$obs.data</code> where we have the observed 2X2 table, <code>smoke.nd$obs.measures</code> (the observed measures of association), <code>smoke.nd$adj.measures</code> (the adjusted measures of association), and <code>smoke.nd$sim.df</code>, a data frame with the simulated variables from each replication, like the Se and Sp, the 4 cells of the adjusted 2X2 table, and the adjusted measures. We can plot the Se prior distribution (and not forgetting to discard the draws that led to negative adjustments).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(smoke.nd<span class="op">$</span>sim.df[<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(smoke.nd<span class="op">$</span>sim.df<span class="op">$</span>corr.RR), ]<span class="op">$</span>seca,</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">     <span class="dt">breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.65</span>, <span class="dv">1</span>, <span class="fl">0.01</span>),</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">     <span class="dt">col =</span> <span class="st">"lightgreen"</span>,</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">     <span class="dt">main =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">     <span class="dt">xlab =</span> <span class="st">"Sensitivity for Cases"</span>)</a></code></pre></div>
<div class="figure">
<img src="episensr_files/figure-html/plot-1.png" alt="Sensibility prior distribution." width="700"><p class="caption">
Sensibility prior distribution.
</p>
</div>
<p>There are combinations of Se, Sp, and disease (or exposure) prevalence that produce negative cells in the corrected 2-by-2 table. For outcome misclassification, this happen when the frequency of observed exposed cases is less than the total number of diseased individuals multiplied by the false-positive proportion. Negative cell counts occur when the false-positive proportion is greater than the proportion of cases that are exposed. When providing values for Se and Sp that are more or less like random classification (i.e. Se ~50% and Sp ~50%), you obtain negative cell values.</p>
</div>
<div id="probabilistic-sensitivity-analysis-for-uncontrolled-confounding" class="section level2">
<h2 class="hasAnchor">
<a href="#probabilistic-sensitivity-analysis-for-uncontrolled-confounding" class="anchor"></a>Probabilistic Sensitivity Analysis for Uncontrolled Confounding</h2>
<p>Let’s illustrate this function with this example from <a href="https://shop.lww.com/Modern-Epidemiology/p/9781451190052">Modern Epidemiology by Rothman, Greenland &amp; Lash</a>, where the association between occupational resins exposure and lung cancer mortality is studied, together with the presence of an unmeasured potential confounder, smoking (<a href="https://www.ncbi.nlm.nih.gov/pubmed/7927843">Greenland et al., 1994</a>).</p>
<table class="table">
<thead><tr class="header">
<th align="right"></th>
<th align="center">Resins exposed</th>
<th align="center">Resins unexposed</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">Cases</td>
<td align="center">45</td>
<td align="center">94</td>
</tr>
<tr class="even">
<td align="right">Controls</td>
<td align="center">257</td>
<td align="center">945</td>
</tr>
</tbody>
</table>
<p>Prior probability distributions are given to each bias parameters. Prevalences of smoking in those exposed to resins, and of smoking in those unexposed to resins receive prior distributions that are uniform between 0.40 and 0.70. Prior distribution for the odds ratio associating smoking with lung cancer mortality is log-normal with 95% limits of 5 and 15. The mean of this distribution is [ln(15) + ln(5)] / 2 = 2.159, and its standard deviation is [ln(15) - ln(5)] / 3.92 = 0.28.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw"><a href="../reference/probsens.conf.html">probsens.conf</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">45</span>, <span class="dv">94</span>, <span class="dv">257</span>, <span class="dv">945</span>),</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                     <span class="dt">dimnames =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Cases+"</span>, <span class="st">"Cases-"</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Res+"</span>, <span class="st">"Res-"</span>)),</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">                     <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">              <span class="dt">reps =</span> <span class="dv">50000</span>,</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">              <span class="dt">prev.exp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"uniform"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">4</span>, <span class="fl">.7</span>)),</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">              <span class="dt">prev.nexp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"uniform"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">4</span>, <span class="fl">.7</span>)),</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">              <span class="dt">risk =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"log-normal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.159</span>, <span class="fl">.28</span>)))</a></code></pre></div>
<pre><code>## --Observed data-- 
##          Outcome: Cases+ 
##        Comparing: Res+ vs. Res- 
## 
##        Res+ Res-
## Cases+   45   94
## Cases-  257  945
## 
##                                      2.5%    97.5%
## Observed Relative Risk: 1.646999 1.182429 2.294094
##    Observed Odds Ratio: 1.760286 1.202457 2.576898
## ---
##                                            Median 2.5th percentile
##            RR (SMR) -- systematic error: 1.648388         1.166250
## RR (SMR) -- systematic and random error: 1.645768         1.018201
##            OR (SMR) -- systematic error: 1.841387         1.209338
## OR (SMR) -- systematic and random error: 1.841158         1.041488
##                                          97.5th percentile
##            RR (SMR) -- systematic error:          2.325654
## RR (SMR) -- systematic and random error:          2.670214
##            OR (SMR) -- systematic error:          2.822182
## OR (SMR) -- systematic and random error:          3.278307</code></pre>
<p>The median adjusted OR is 1.84 [1.21,2.81].</p>
=======
<p>Additional information are also available, like the 2X2 tables by levels of the confounder.</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co">## Confounder +</span>
<span class="va">tyndall</span><span class="op">$</span><span class="va">cfder.data</span></pre></div>
<pre><code>##          Circ+    Circ-
## HIV+  75.17045 2.727967
## HIV- 430.42955 6.172033</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="co">## Confounder -</span>
<span class="va">tyndall</span><span class="op">$</span><span class="va">nocfder.data</span></pre></div>
<pre><code>##         Circ+    Circ-
## HIV+ 29.82955 82.27203
## HIV- 96.57045 86.82797</code></pre>
>>>>>>> develop
</div>
<div id="bootstrapping" class="section level2">
<h2 class="hasAnchor">
<a href="#bootstrapping" class="anchor"></a>Bootstrapping</h2>
<p>Selection and misclassification bias models can be bootstrapped in order to get confidence interval on the adjusted association parameter. We can use the ICU dataset from Hosmer and Lemeshow <a href="http://ca.wiley.com/WileyCDA/WileyTitle/productCd-0470582472.html">Applied Logistic Regression</a> textbook as an example. The replicates that give negative cells in the adjusted 2X2 table are silently ignored and the number of effective bootstrap replicates is provided in the output. Ten thousands bootstrap samples are a good number for testing everything runs smoothly. But again, don’t be afraid of running more, like 100,000 bootstrap samples.</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lbraglia/aplore3">aplore3</a></span><span class="op">)</span>  <span class="co"># to get ICU data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">icu</span><span class="op">)</span>

<span class="co">## First run the model</span>
<span class="va">misclass_eval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/misclassification.html">misclassification</a></span><span class="op">(</span><span class="va">icu</span><span class="op">$</span><span class="va">sta</span>, <span class="va">icu</span><span class="op">$</span><span class="va">inf</span>,
                                   type <span class="op">=</span> <span class="st">"exposure"</span>,
                                   bias_parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.75</span>, <span class="fl">.85</span>, <span class="fl">.9</span>, <span class="fl">.95</span><span class="op">)</span><span class="op">)</span>
<span class="va">misclass_eval</span></pre></div>
<pre><code>## --Observed data-- 
##          Outcome: Died 
##        Comparing: Yes vs. No 
## 
##        exposed
## case    Yes  No
##   Died   24  16
##   Lived  60 100
## 
##                                      2.5%    97.5%
## Observed Relative Risk: 2.071429 1.175157 3.651272
##    Observed Odds Ratio: 2.500000 1.230418 5.079573
## ---
##                                                                2.5%     97.5%
## Misclassification Bias Corrected Relative Risk:  3.627845                    
##    Misclassification Bias Corrected Odds Ratio:  4.871795  1.235506 19.210258</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="co">## Then bootstrap it</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">misclass_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boot.bias.html">boot.bias</a></span><span class="op">(</span><span class="va">misclass_eval</span>, R <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span>
<span class="va">misclass_boot</span></pre></div>
<pre><code>## 95 % confidence interval of the bias adjusted measures: 
##    RR: 0.9595117 11.96789 
##    OR: 1.075386 19.44271 
## ---
##  Based on 9562 bootstrap replicates</code></pre>
<p>Bootstrap replicates can also be plotted, with the confidence interval shown as dotted lines.</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">misclass_boot</span>, <span class="st">"rr"</span><span class="op">)</span></pre></div>
<div class="figure">
<img src="episensr_files/figure-html/boot_fig-1.png" alt="Bootstrap replicates and confidence interval." width="700"><p class="caption">
Bootstrap replicates and confidence interval.
</p>
</div>
</div>
<<<<<<< HEAD
<div id="multiple-bias-modeling" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-bias-modeling" class="anchor"></a>Multiple bias modeling</h2>
<p>Epidemiologic studies can suffer from more than one bias. Bias functions in <code>episensr</code> can be applied sequentially to quantify bias resulting from multiple biases.</p>
<p>Following the example in <a href="https://www.springer.com/us/book/9780387879604">Lash et al.</a>, we can use the study by <a href="https://link.springer.com/article/10.1007%2Fs10549-005-9056-0">Chien et al.</a>. It is a case-control study looking at the association between antidepressant use and the occurrence of breast cancer. The observed OR was 1.2 [0.9–1.6].</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">chien &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">118</span>, <span class="dv">832</span>, <span class="dv">103</span>, <span class="dv">884</span>),</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">                <span class="dt">dimnames =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"BC+"</span>, <span class="st">"BC-"</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AD+"</span>, <span class="st">"AD-"</span>)),</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">                <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">AD+</th>
<th align="right">AD-</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>BC+</td>
<td align="right">118</td>
<td align="right">832</td>
</tr>
<tr class="even">
<td>BC-</td>
<td align="right">103</td>
<td align="right">884</td>
</tr>
</tbody>
</table>
<p>Records on medication use differed between participants, from pharmacy records and self-reported use, leading to misclassification:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">chien <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="../reference/misclassification.html">misclassification</a></span>(., <span class="dt">type =</span> <span class="st">"exposure"</span>, <span class="dt">bias_parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">56</span>, <span class="fl">.58</span>, <span class="fl">.99</span>, <span class="fl">.97</span>))</a></code></pre></div>
<pre><code>## --Observed data-- 
##          Outcome: BC+ 
##        Comparing: AD+ vs. AD- 
## 
##     AD+ AD-
## BC+ 118 832
## BC- 103 884
## 
##                                        2.5%     97.5%
## Observed Relative Risk: 1.1012443 0.9646019 1.2572431
##    Observed Odds Ratio: 1.2172330 0.9192874 1.6117443
## ---
##                                                              2.5%    97.5%
## Misclassification Bias Corrected Relative Risk: 1.272939                  
##    Misclassification Bias Corrected Odds Ratio: 1.676452 1.150577 2.442679</code></pre>
<p>Controls and cases also enrolled into the study at different rates. We can combine the misclassification bias with a selection bias thanks to the function <code>multiple.bias</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">chien <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="../reference/misclassification.html">misclassification</a></span>(., <span class="dt">type =</span> <span class="st">"exposure"</span>, <span class="dt">bias_parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">56</span>, <span class="fl">.58</span>, <span class="fl">.99</span>, <span class="fl">.97</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="../reference/multiple.bias.html">multiple.bias</a></span>(., <span class="dt">bias_function =</span> <span class="st">"selection"</span>, <span class="dt">bias_parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">73</span>, <span class="fl">.61</span>, <span class="fl">.82</span>, <span class="fl">.76</span>))</a></code></pre></div>
<pre><code>## 
## Multiple bias analysis
## ---
##                                                 
## Selection Bias Corrected Relative Risk: 1.192461
##    Selection Bias Corrected Odds Ratio: 1.512206</code></pre>
<p>The association between antidepressant use and breast cancer was adjusted for various confounders (race/ethnicity, income, etc.). None of these confounders were found to change the association by more than 10%. However, for illustration, we can add the effect of a potential confounder ( e.g. physical activity):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">chien <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="../reference/misclassification.html">misclassification</a></span>(., <span class="dt">type =</span> <span class="st">"exposure"</span>, <span class="dt">bias_parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">56</span>, <span class="fl">.58</span>, <span class="fl">.99</span>, <span class="fl">.97</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="../reference/multiple.bias.html">multiple.bias</a></span>(., <span class="dt">bias_function =</span> <span class="st">"selection"</span>,</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">                  <span class="dt">bias_parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">73</span>, <span class="fl">.61</span>, <span class="fl">.82</span>, <span class="fl">.76</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="st">    </span><span class="kw"><a href="../reference/multiple.bias.html">multiple.bias</a></span>(., <span class="dt">bias_function =</span> <span class="st">"confounders"</span>,</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">                  <span class="dt">type =</span> <span class="st">"OR"</span>, <span class="dt">bias_parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">92</span>, <span class="fl">.3</span>, <span class="fl">.44</span>))</a></code></pre></div>
<pre><code>## 
## Multiple bias analysis
## ---
##                                        Adjusted OR
## Standardized Morbidity Ratio: 1.494938    1.011609
##              Mantel-Haenszel: 1.494938    1.011609</code></pre>
<p>We can do the same in a probabilistic framework:</p>
<ul>
<li>Misclassification bias</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">mod1 &lt;-<span class="st"> </span>chien <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="../reference/probsens.html">probsens</a></span>(., <span class="dt">type =</span> <span class="st">"exposure"</span>, <span class="dt">reps =</span> <span class="dv">100000</span>,</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">             <span class="dt">seca.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">45</span>, <span class="fl">.5</span>, <span class="fl">.6</span>, <span class="fl">.65</span>)),</a>
<a class="sourceLine" id="cb28-4" data-line-number="4">             <span class="dt">seexp.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">4</span>, <span class="fl">.48</span>, <span class="fl">.58</span>, <span class="fl">.63</span>)),</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">             <span class="dt">spca.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">95</span>, <span class="fl">.97</span>, <span class="fl">.99</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">             <span class="dt">spexp.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">96</span>, <span class="fl">.98</span>, <span class="fl">.99</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb28-7" data-line-number="7">             <span class="dt">corr.se =</span> <span class="fl">.8</span>, <span class="dt">corr.sp =</span> <span class="fl">.8</span>)</a>
<a class="sourceLine" id="cb28-8" data-line-number="8">mod1</a></code></pre></div>
<pre><code>## --Observed data-- 
##          Outcome: BC+ 
##        Comparing: AD+ vs. AD- 
## 
##     AD+ AD-
## BC+ 118 832
## BC- 103 884
## 
##                                         2.5%     97.5%
##  Observed Relative Risk: 1.1012443 0.9646019 1.2572431
##     Observed Odds Ratio: 1.2172330 0.9192874 1.6117443
## ---
##                                                  Median 2.5th percentile
##            Relative Risk -- systematic error: 1.0709983        0.9541064
##               Odds Ratio -- systematic error: 1.1474450        0.9130899
## Relative Risk -- systematic and random error: 1.0700809        0.8982833
##    Odds Ratio -- systematic and random error: 1.1469684        0.7989579
##                                               97.5th percentile
##            Relative Risk -- systematic error:         1.1892552
##               Odds Ratio -- systematic error:         1.4339600
## Relative Risk -- systematic and random error:         1.2665725
##    Odds Ratio -- systematic and random error:         1.6371782</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(mod1<span class="op">$</span>sim.df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> corr.OR)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">y =</span> ..density..), <span class="dt">colour =</span> <span class="st">"black"</span>, <span class="dt">fill =</span> <span class="st">"white"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span>(<span class="dt">alpha =</span> <span class="fl">.2</span>, <span class="dt">fill =</span> <span class="st">"#FF6666"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"1. Misclassification bias"</span>, <span class="dt">x =</span> <span class="st">"OR without random error incorporated"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">3</span>))</a></code></pre></div>
<p><img src="episensr_files/figure-html/plot2-1.png" width="700"></p>
<ul>
<li>Selection bias</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">mod2 &lt;-<span class="st"> </span>chien <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="../reference/probsens.sel.html">probsens.sel</a></span>(., <span class="dt">reps =</span> <span class="dv">100000</span>,</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">                 <span class="dt">case.exp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"logit-normal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">1.1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">                 <span class="dt">case.nexp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">75</span>, <span class="fl">.85</span>, <span class="fl">.95</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">                 <span class="dt">ncase.exp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"logit-normal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">1.2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb31-6" data-line-number="6">                 <span class="dt">ncase.nexp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb31-7" data-line-number="7">mod2</a></code></pre></div>
<pre><code>## --Observed data-- 
##          Outcome: BC+ 
##        Comparing: AD+ vs. AD- 
## 
##     AD+ AD-
## BC+ 118 832
## BC- 103 884
## 
##                                     2.5%     97.5%
## Observed Odds Ratio: 1.2172330 0.9192874 1.6117443
## ---
##                                               Median 2.5th percentile
##            Odds Ratio -- systematic error: 1.1762682        0.9718428
## Odds Ratio -- systematic and random error: 1.1762476        0.8352644
##                                            97.5th percentile
##            Odds Ratio -- systematic error:         1.4235736
## Odds Ratio -- systematic and random error:         1.6547397</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(mod2<span class="op">$</span>sim.df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> corr.or)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">y =</span> ..density..), <span class="dt">colour =</span> <span class="st">"black"</span>, <span class="dt">fill =</span> <span class="st">"white"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span>(<span class="dt">alpha =</span> <span class="fl">.2</span>, <span class="dt">fill =</span> <span class="st">"#FF6666"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"2. Selection bias"</span>, <span class="dt">x =</span> <span class="st">"OR without random error incorporated"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-5" data-line-number="5"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">3</span>))</a></code></pre></div>
<p><img src="episensr_files/figure-html/plot3-1.png" width="700"></p>
<ul>
<li>Confounding</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">mod3 &lt;-<span class="st"> </span>chien <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="../reference/probsens.conf.html">probsens.conf</a></span>(., <span class="dt">reps =</span> <span class="dv">100000</span>,</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">                  <span class="dt">prev.exp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"logit-normal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">0.75</span>, <span class="fl">0.8</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">                  <span class="dt">prev.nexp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"logit-normal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">                  <span class="dt">risk =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">2</span>, <span class="fl">.58</span>, <span class="fl">1.01</span>, <span class="fl">1.24</span>)))</a></code></pre></div>
<pre><code>## Chosen prior Prevalence distributions lead to 2 negative adjusted counts which were discarded.</code></pre>
<pre><code>## Warning in log(draws[, 7]): NaNs produced</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">mod3</a></code></pre></div>
<pre><code>## --Observed data-- 
##          Outcome: BC+ 
##        Comparing: AD+ vs. AD- 
## 
##     AD+ AD-
## BC+ 118 832
## BC- 103 884
## 
##                                        2.5%     97.5%
## Observed Relative Risk: 1.1012443 0.9646019 1.2572431
##    Observed Odds Ratio: 1.2172330 0.9192874 1.6117443
## ---
##                                             Median 2.5th percentile
##            RR (SMR) -- systematic error: 1.1012533        0.8860939
## RR (SMR) -- systematic and random error: 1.1012224        0.8620908
##            OR (SMR) -- systematic error: 1.2190270        0.7198169
## OR (SMR) -- systematic and random error: 1.2253934        0.6940221
##                                          97.5th percentile
##            RR (SMR) -- systematic error:         1.3643095
## RR (SMR) -- systematic and random error:         1.4027257
##            OR (SMR) -- systematic error:         2.0542029
## OR (SMR) -- systematic and random error:         2.1683633</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(mod3<span class="op">$</span>sim.df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> OR.SMR.or)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">y =</span> ..density..), <span class="dt">colour =</span> <span class="st">"black"</span>, <span class="dt">fill =</span> <span class="st">"white"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span>(<span class="dt">alpha =</span> <span class="fl">.2</span>, <span class="dt">fill =</span> <span class="st">"#FF6666"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"3. Confounding bias"</span>, <span class="dt">x =</span> <span class="st">"OR without random error incorporated"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">3</span>))</a></code></pre></div>
<p><img src="episensr_files/figure-html/plot4-1.png" width="700"></p>
<ul>
<li>Misclassification then selection</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">chien <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="../reference/probsens.html">probsens</a></span>(., <span class="dt">type =</span> <span class="st">"exposure"</span>, <span class="dt">reps =</span> <span class="dv">100000</span>,</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">             <span class="dt">seca.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">45</span>, <span class="fl">.5</span>, <span class="fl">.6</span>, <span class="fl">.65</span>)),</a>
<a class="sourceLine" id="cb40-4" data-line-number="4">             <span class="dt">seexp.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">4</span>, <span class="fl">.48</span>, <span class="fl">.58</span>, <span class="fl">.63</span>)),</a>
<a class="sourceLine" id="cb40-5" data-line-number="5">             <span class="dt">spca.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">95</span>, <span class="fl">.97</span>, <span class="fl">.99</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb40-6" data-line-number="6">             <span class="dt">spexp.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">96</span>, <span class="fl">.98</span>, <span class="fl">.99</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb40-7" data-line-number="7">             <span class="dt">corr.se =</span> <span class="fl">.8</span>, <span class="dt">corr.sp =</span> <span class="fl">.8</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8"><span class="st">    </span><span class="kw"><a href="../reference/multiple.bias.html">multiple.bias</a></span>(., <span class="dt">bias_function =</span> <span class="st">"probsens.sel"</span>,</a>
<a class="sourceLine" id="cb40-9" data-line-number="9">                  <span class="dt">case.exp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"logit-normal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">1.1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb40-10" data-line-number="10">                  <span class="dt">case.nexp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">75</span>, <span class="fl">.85</span>, <span class="fl">.95</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb40-11" data-line-number="11">                  <span class="dt">ncase.exp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"logit-normal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">1.2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb40-12" data-line-number="12">                  <span class="dt">ncase.nexp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="dv">1</span>)))</a></code></pre></div>
<pre><code>## 
## Multiple bias analysis
## ---
##                                               Median 2.5th percentile
##            Odds Ratio -- systematic error: 1.1210109        0.9240765
## Odds Ratio -- systematic and random error: 1.1202286        0.8447960
##                                            97.5th percentile
##            Odds Ratio -- systematic error:         1.3411515
## Odds Ratio -- systematic and random error:         1.5091203</code></pre>
<ul>
<li>Misclassification, selection, and confounding</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">mod6 &lt;-<span class="st"> </span>chien <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="../reference/probsens.html">probsens</a></span>(., <span class="dt">type =</span> <span class="st">"exposure"</span>, <span class="dt">reps =</span> <span class="dv">100000</span>,</a>
<a class="sourceLine" id="cb42-3" data-line-number="3">             <span class="dt">seca.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">45</span>, <span class="fl">.5</span>, <span class="fl">.6</span>, <span class="fl">.65</span>)),</a>
<a class="sourceLine" id="cb42-4" data-line-number="4">             <span class="dt">seexp.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">4</span>, <span class="fl">.48</span>, <span class="fl">.58</span>, <span class="fl">.63</span>)),</a>
<a class="sourceLine" id="cb42-5" data-line-number="5">             <span class="dt">spca.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">95</span>, <span class="fl">.97</span>, <span class="fl">.99</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb42-6" data-line-number="6">             <span class="dt">spexp.parms =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">96</span>, <span class="fl">.98</span>, <span class="fl">.99</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb42-7" data-line-number="7">             <span class="dt">corr.se =</span> <span class="fl">.8</span>, <span class="dt">corr.sp =</span> <span class="fl">.8</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="st">    </span><span class="kw"><a href="../reference/multiple.bias.html">multiple.bias</a></span>(., <span class="dt">bias_function =</span> <span class="st">"probsens.sel"</span>,</a>
<a class="sourceLine" id="cb42-9" data-line-number="9">                  <span class="dt">case.exp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"logit-normal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">1.1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb42-10" data-line-number="10">                  <span class="dt">case.nexp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">75</span>, <span class="fl">.85</span>, <span class="fl">.95</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb42-11" data-line-number="11">                  <span class="dt">ncase.exp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"logit-normal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">1.2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb42-12" data-line-number="12">                  <span class="dt">ncase.nexp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-13" data-line-number="13"><span class="st">    </span><span class="kw"><a href="../reference/multiple.bias.html">multiple.bias</a></span>(., <span class="dt">bias_function =</span> <span class="st">"probsens.conf"</span>,</a>
<a class="sourceLine" id="cb42-14" data-line-number="14">                  <span class="dt">prev.exp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"logit-normal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">0.75</span>, <span class="fl">0.8</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb42-15" data-line-number="15">                  <span class="dt">prev.nexp =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"logit-normal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb42-16" data-line-number="16">                  <span class="dt">risk =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"trapezoidal"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">2</span>, <span class="fl">.58</span>, <span class="fl">1.01</span>, <span class="fl">1.24</span>)))</a>
<a class="sourceLine" id="cb42-17" data-line-number="17">mod6</a></code></pre></div>
<pre><code>## 
## Multiple bias analysis
## ---
##                                             Median 2.5th percentile
##            RR (SMR) -- systematic error: 1.0725491        0.8750890
## RR (SMR) -- systematic and random error: 1.0727636        0.8593872
##            OR (SMR) -- systematic error: 1.1525015        0.7094781
## OR (SMR) -- systematic and random error: 1.1575751        0.6883031
##                                          97.5th percentile
##            RR (SMR) -- systematic error:         1.3165332
## RR (SMR) -- systematic and random error:         1.3289895
##            OR (SMR) -- systematic error:         1.8635161
## OR (SMR) -- systematic and random error:         1.9119423</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(mod6<span class="op">$</span>sim.df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> OR.SMR.or)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">y =</span> ..density..), <span class="dt">colour =</span> <span class="st">"black"</span>, <span class="dt">fill =</span> <span class="st">"white"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span>(<span class="dt">alpha =</span> <span class="fl">.2</span>, <span class="dt">fill =</span> <span class="st">"#FF6666"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-4" data-line-number="4"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"6. Misclassification, then</span><span class="ch">\n</span><span class="st">selection, then confounding"</span>,</a>
<a class="sourceLine" id="cb44-5" data-line-number="5">         <span class="dt">x =</span> <span class="st">"OR without random error incorporated"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-6" data-line-number="6"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">3</span>))</a></code></pre></div>
<p><img src="episensr_files/figure-html/plot5-1.png" width="700"></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(mod6<span class="op">$</span>sim.df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> tot.ORadj.smr)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">y =</span> ..density..), <span class="dt">colour =</span> <span class="st">"black"</span>, <span class="dt">fill =</span> <span class="st">"white"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span>(<span class="dt">alpha =</span> <span class="fl">.2</span>, <span class="dt">fill =</span> <span class="st">"#FF6666"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"6. Misclassification, then</span><span class="ch">\n</span><span class="st">selection, then confounding"</span>,</a>
<a class="sourceLine" id="cb45-5" data-line-number="5">         <span class="dt">x =</span> <span class="st">"OR with random error incorporated"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-6" data-line-number="6"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">3</span>))</a></code></pre></div>
<p><img src="episensr_files/figure-html/plot5-2.png" width="700"></p>
</div>
=======
>>>>>>> develop
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Denis Haine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
